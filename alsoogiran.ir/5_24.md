### گزارش تست سرعت و بهینه‌سازی وبسایت **السوق الایران**  
بررسی بر اساس شاخص‌های مهم SEO و عملکرد وبسایت برای کاربران موبایل انجام شده است. نتایج به تفکیک ارائه می‌شود:

---

#### **1. شاخص‌های عملکرد اصلی**  
**Largest Contentful Paint (LCP):**  
- **زمان کل:** 10,800 میلی‌ثانیه  
- **تاخیر در بارگذاری:** 8,970 میلی‌ثانیه (83%)  
- **منابع اصلی تأثیرگذار:**  
  - عنصر: `<div class="swiper-slide-bg">`  
  - تصاویر بزرگ مانند `shoes.png` و `23.png`  
- پیشنهاد: استفاده از **تصاویر در فرمت‌های نسل جدید** (WebP، AVIF).

**TTFB (زمان پاسخ اولیه سرور):**  
- **600 میلی‌ثانیه**  
- نیازمند بهینه‌سازی بیشتر در پاسخ‌دهی سرور.

---

#### **2. مشکلات و پیشنهادات بهینه‌سازی**  

**2.1 حذف منابع مسدودکننده رندر**  
- **صرفه‌جویی احتمالی:** 3,180 میلی‌ثانیه  
- **منابع تأثیرگذار:**  
  - فایل‌های CSS و JS مانند `dashicons.min.css` و `jquery.min.js`.  
- **راهکار:**  
  - استفاده از افزونه‌هایی مانند **WP Rocket** برای حذف CSS و جاوااسکریپت‌های غیرضروری.  
  - بارگذاری منابع به صورت تأخیری.

**2.2 کاهش حجم فایل‌های CSS بدون استفاده**  
- **صرفه‌جویی احتمالی:** 181 کیلوبایت  
- **منابع تأثیرگذار:**  
  - `js_composer.min.css` و `frontend-rtl.min.css`.  
- **پیشنهاد:** فعال‌سازی **حذف CSS‌های غیرضروری** در WP Rocket.

**2.3 کاهش حجم فایل‌های جاوااسکریپت بدون استفاده**  
- **صرفه‌جویی احتمالی:** 196 کیلوبایت  
- **منابع تأثیرگذار:**  
  - `rs6.min.js` و `rbtools.min.js`.  
- **پیشنهاد:**  
  - تأخیر در اجرای جاوااسکریپت تا زمان تعامل کاربر.  

---

#### **3. تصاویر و بهینه‌سازی آنها**  
**3.1 تصاویر در فرمت‌های قدیمی:**  
- صرفه‌جویی بالقوه در حجم: **1,030 کیلوبایت**  
- تصاویر تأثیرگذار:  
  - `shoes.png`، `23.png`، و `Asooqiran.png`.  
- **راهکار:**  
  - تبدیل تصاویر به فرمت **WebP** با ابزارهایی مانند افزونه Performance Lab.

**3.2 تنظیم ابعاد تصاویر:**  
- برخی تصاویر بدون ابعاد مشخص هستند (مانند `Asooqiran.png`).  
- این موضوع باعث جابجایی چیدمان (CLS) می‌شود.  
- **پیشنهاد:** تعیین عرض و ارتفاع برای تصاویر.

---

#### **4. مدیریت کش و منابع ثابت**  
**مشکل:**  
- عدم استفاده از **سیاست کش مناسب** برای 126 منبع استاتیک.  
- **نمونه‌ها:**  
  - `shoes.png`، `Lalezar-Regular.ttf`، و `rs6.min.js`.  
- **راهکار:**  
  - تعیین عمر کش طولانی‌تر (مانند 30 روز) برای منابع ثابت.  

---

### **جمع‌بندی و اولویت‌بندی اقدامات**  
1. **بهینه‌سازی تصاویر:** تبدیل به فرمت WebP و تعیین ابعاد.  
2. **حذف منابع مسدودکننده رندر:** حذف CSS و JS غیرضروری.  
3. **بهینه‌سازی کش:** تنظیم TTL مناسب برای منابع استاتیک.  
4. **بهبود پاسخ‌دهی سرور (TTFB):** بررسی زیرساخت و هاست.  

این اقدامات به بهبود چشمگیر عملکرد سایت و افزایش رضایت کاربران منجر خواهد شد.

---

### **1. [aria-*] Attributes Do Not Match Their Roles**
- **مشکل:** برخی از نقش‌های ARIA (مانند `role="document"`) باید با مقادیر مشخصی از ویژگی‌های ARIA (مانند `aria-modal` یا `aria-labelledby`) همراه باشند. اگر این مطابقت وجود نداشته باشد، ویژگی‌ها بی‌اعتبار می‌شوند و ممکن است باعث مشکلاتی برای کاربران فناوری‌های کمکی مانند خواننده‌های صفحه شود.
- **عنصر ناموفق:** 
  ```html
  <div class="dialog-widget ... aria-modal="true" role="document" ...>
  ```
- **راهکار:** مطمئن شوید که نقش ARIA تعریف‌شده با ویژگی‌های آن سازگار است. برای مثال، برای `role="document"`، بهتر است ویژگی‌هایی مانند `aria-labelledby` یا `aria-describedby` را اضافه کنید تا محتوا را برای کاربران فناوری‌های کمکی قابل فهم‌تر کنید.

---

### **2. `user-scalable="no"` in `<meta>`**
- **مشکل:** استفاده از `user-scalable="no"` یا محدود کردن زوم به کمتر از `5` در تگ `<meta>` باعث می‌شود کاربران با مشکلات بینایی نتوانند صفحه را به درستی بزرگنمایی کنند.
- **عنصر ناموفق:**
  ```html
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  ```
- **راهکار:** مقدار `maximum-scale` را به 5 یا بالاتر تنظیم کرده و `user-scalable` را حذف کنید تا کاربران امکان بزرگنمایی داشته باشند. مثال:
  ```html
  <meta name="viewport" content="width=device-width, initial-scale=1.0, initial-scale=1.0">
  ```

---

### **3. Touch Targets Do Not Have Sufficient Size or Spacing**
- **مشکل:** عناصر قابل کلیک (مانند دکمه‌ها یا لینک‌ها) دارای اندازه یا فاصله کافی نیستند و برای کاربران دشوار است که به راحتی آنها را لمس کنند.
- **عناصر ناموفق:**
  ```html
  <span class="swiper-pagination-bullet" tabindex="0" role="button" aria-label="Go to slide 2">
  ```
- **راهکار:** اطمینان حاصل کنید که عناصر قابل لمس حداقل اندازه 48x48 پیکسل داشته باشند و فضای کافی بین آنها در نظر گرفته شود. می‌توانید از CSS برای تنظیم فاصله و اندازه استفاده کنید:
  ```css
  .button {
      min-width: 48px;
      min-height: 48px;
      margin: 8px;
  }
  ```

---

### **4. Contrast Issues**
- **مشکل:** نسبت کنتراست بین رنگ پس‌زمینه و متن کافی نیست. این امر می‌تواند خواندن متن را برای کاربران دشوار یا غیرممکن کند.
- **عناصر ناموفق:**
  ```html
  <a class="elementor-cta__button elementor-button elementor-size-sm" href="https://alsooqiran.com/product-category/bags-and-shoes/">مشاهدة المنتجات</a>
  ```
- **راهکار:** از ابزارهایی مانند [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/) استفاده کنید تا اطمینان حاصل شود که نسبت کنتراست حداقل 4.5:1 برای متن‌های کوچک و 3:1 برای متن‌های بزرگ رعایت شده است. مثالی از بهبود رنگ‌ها:
  ```css
  .button {
      color: #FFFFFF;
      background-color: #007BFF;
  }
  ```

---

### **بهبودهای کلی دسترسی:**
1. **استفاده مناسب از ARIA:** نقش‌ها و ویژگی‌های ARIA را مطابق با نیازها تنظیم کنید.
2. **زوم صفحه:** زوم را غیرفعال نکنید و به کاربران امکان دسترسی به صفحه با بزرگنمایی مناسب بدهید.
3. **اندازه لمس:** عناصر تعاملی را بزرگ‌تر کرده و فاصله مناسب بین آنها قرار دهید.
4. **کنتراست رنگ‌ها:** رنگ پس‌زمینه و متن را طوری انتخاب کنید که متن واضح و خوانا باشد.

برای هر یک از این مشکلات، اصلاحات باید به نحوی باشد که تجربه کاربری بهتری برای همه کاربران ایجاد کند، به ویژه کسانی که به فناوری‌های کمکی متکی هستند.


---

# **1. خطاهای گزارش‌شده در کنسول مرورگر**
- **مشکل:** وجود خطاهای ثبت‌شده در کنسول نشان‌دهنده مشکلات حل‌نشده در کد است. این خطاها ممکن است از شکست درخواست‌های شبکه، مشکلات اسکریپت‌های جاوااسکریپت یا سایر نگرانی‌های مربوط به مرورگر ناشی شود.
  
#### **خطای مشخص‌شده:**
- **Source:** `alsooqiran.com`
- **Description:** 
  ```
  ReferenceError: mapboxgl is not defined 
  at HTMLDocument.<anonymous> (https://alsooqiran.com/:457:17) 
  at e (https://alsooqiran.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1:2:27028) 
  at t (https://alsooqiran.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1:2:27330)
  ```

---

### **تحلیل و راهکارهای پیشنهادی:**

#### **خطای `ReferenceError: mapboxgl is not defined`**
- **تحلیل:**
  این خطا به دلیل عدم بارگذاری صحیح کتابخانه Mapbox GL JS رخ می‌دهد. این کتابخانه باید قبل از هرگونه استفاده در کد (مانند ایجاد نقشه‌ها یا افزودن داده‌های مکانی) بارگذاری شود.
  
- **راهکار:**
  1. **بررسی اسکریپت Mapbox:** اطمینان حاصل کنید که لینک‌های Mapbox GL JS به درستی در فایل HTML یا تنظیمات CMS بارگذاری شده است. برای مثال:
     ```html
     <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
     <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
     ```
  2. **ترتیب بارگذاری:** مطمئن شوید که کدهای وابسته به Mapbox GL فقط پس از بارگذاری کامل کتابخانه اجرا می‌شوند:
     ```javascript
     document.addEventListener('DOMContentLoaded', function() {
         if (typeof mapboxgl !== 'undefined') {
             // Initialize Mapbox map here
         } else {
             console.error('Mapbox GL JS not loaded.');
         }
     });
     ```

#### **مشکل عمومی با `jquery.min.js`**
- **تحلیل:**
  ارجاع به فایل `jquery.min.js` در خطای بالا نشان می‌دهد که احتمالاً یک تابع یا ویژگی جاوااسکریپت در کتابخانه جی‌کوئری استفاده شده که خطا ایجاد کرده است.
  
- **راهکار:**
  1. **به‌روزرسانی کتابخانه‌ها:** نسخه جی‌کوئری و افزونه‌های وابسته را به‌روزرسانی کنید تا با نسخه فعلی وردپرس و پلاگین‌های آن هماهنگ باشد.
  2. **رفع ارجاع‌های نادرست:** خطاهای وابسته به جی‌کوئری ممکن است از اسکریپت‌های سفارشی یا پلاگین‌های ناسازگار ناشی شده باشند. با غیرفعال کردن افزونه‌ها یا بررسی کد سفارشی مشکل را شناسایی کنید.

---

### **توصیه‌های کلی برای رفع خطاهای کنسول:**
1. **بررسی کامل کنسول مرورگر:** ابزار توسعه‌دهنده (DevTools) مرورگر خود را باز کرده و بخش Console را برای مشاهده خطاها و هشدارها بررسی کنید.
2. **تست شبکه:** اگر خطاها به شکست درخواست‌های شبکه مرتبط هستند، سربرگ Network در DevTools را بررسی کنید تا درخواست‌های شکست‌خورده را پیدا کنید.
3. **استفاده از ابزارهای اشکال‌زدایی:** برای شناسایی خطاهای جاوااسکریپت و رفع آنها از ابزارهایی مانند ESLint یا Debugger در DevTools استفاده کنید.
4. **رفع تناقض در بارگذاری منابع:** منابع خارجی مانند Mapbox یا سایر کتابخانه‌ها را بررسی کنید و مطمئن شوید که به درستی بارگذاری شده‌اند.


# **گزارش مشکل: عدم وجود سورس‌مپ برای فایل‌های جاوااسکریپت بزرگ**

---

#### **مشکل:**
سورس‌مپ (Source Map) فایل‌های جاوااسکریپت برای تطابق کد مینیفای‌شده (minified) با کد اصلی استفاده می‌شوند. عدم وجود این فایل‌ها فرآیند دیباگ در محیط پروداکشن را دشوار می‌کند و مانع ارائه اطلاعات دقیق‌تر توسط ابزارهایی مثل Lighthouse می‌شود.

---

#### **جزئیات مشکل:**

- **URL:** `https://alsooqiran.com`
- **فایل‌های مشکل‌دار:**
  - `swiper.min.js?ver=8.4.5`
  - `swiper-bundle.min.js.map`
- **خطا:** 
  ```
  Error: Timed out fetching resource
  ```

---

### **تحلیل و راهکارهای پیشنهادی:**

#### **1. بررسی و تولید سورس‌مپ‌ها**
- **تحلیل:** فایل‌های جاوااسکریپت مانند `swiper.min.js` فاقد فایل‌های سورس‌مپ هستند. سورس‌مپ‌ها از طریق ابزارهای build مانند Webpack یا Gulp هنگام کامپایل و مینیفای کردن کد تولید می‌شوند.
  
- **راهکار:**
  1. **تولید سورس‌مپ با Webpack:**
     اگر از Webpack استفاده می‌کنید، قابلیت تولید سورس‌مپ را فعال کنید:
     ```javascript
     module.exports = {
         mode: 'production',
         devtool: 'source-map', // تولید سورس‌مپ
     };
     ```
  2. **تولید سورس‌مپ با Gulp:**
     اگر از Gulp استفاده می‌کنید:
     ```javascript
     const gulp = require('gulp');
     const sourcemaps = require('gulp-sourcemaps');
     const uglify = require('gulp-uglify');

     gulp.task('scripts', function() {
         return gulp.src('src/**/*.js')
             .pipe(sourcemaps.init())
             .pipe(uglify())
             .pipe(sourcemaps.write('./'))
             .pipe(gulp.dest('dist'));
     });
     ```

#### **2. بررسی افزونه‌های وردپرس**
- بررسی کنید که آیا پلاگین‌ها یا قالب وردپرس فایل‌های جاوااسکریپت مورد نظر را بارگذاری می‌کنند یا خیر. اگر این فایل‌ها توسط افزونه‌ها مدیریت می‌شوند:
  - سورس‌مپ‌ها را از توسعه‌دهندگان پلاگین درخواست کنید.
  - یا نسخه اصلی پلاگین را به‌روز کنید.

#### **3. افزودن سورس‌مپ‌های Missing**
- اگر سورس‌مپ‌های مورد نظر موجود نیستند، اطمینان حاصل کنید که فایل‌های `.map` مربوطه روی سرور قرار گرفته‌اند و در مسیر مشخص شده در کد قابل دسترسی هستند.
  - بررسی کنید آیا مسیرهای زیر قابل دسترسی هستند:
    - `https://alsooqiran.com/path/to/swiper-bundle.min.js.map`
    - یا هر مسیر مشخص شده در تنظیمات فایل‌های جاوااسکریپت.

---

#### **مزایای حل مشکل:**
1. **بهبود فرآیند دیباگ:** توسعه‌دهندگان می‌توانند از سورس‌مپ‌ها برای مشاهده و رفع باگ‌ها در کد اصلی استفاده کنند.
2. **عملکرد بهتر ابزارها:** ابزارهایی مانند Lighthouse قادر به ارائه تحلیل‌های دقیق‌تر خواهند بود.
3. **بهبود نگهداری:** در صورت بروز مشکلات، کدها بهتر قابل شناسایی و مدیریت خواهند بود.

---

### **توصیه کلی:**
- با توجه به وابستگی سایت شما به فایل‌های مینیفای‌شده، اضافه کردن سورس‌مپ‌ها به چرخه توسعه و استقرار پروژه، دیباگ و بهینه‌سازی را بسیار آسان‌تر می‌کند.

### **گزارش مشکل: مشکلات مرتبط با کراولینگ و ایندکسینگ**

---

#### **1. لینک‌های غیرقابل کراول شدن (Uncrawlable Links)**

##### **مشکل:**
- لینک‌های سایت فاقد ویژگی `href` هستند یا این ویژگی به‌درستی مقداردهی نشده است. این موضوع باعث می‌شود موتورهای جستجو نتوانند صفحات مربوطه را کراول و ایندکس کنند.

##### **جزئیات لینک‌های مشکل‌دار:**
- متن لینک: `مشاهدة المنتجات`
  ```html
  <a class="elementor-cta__button elementor-button elementor-size-sm">
  ```
- متن لینک: `قراردادن محصولات`
  ```html
  <a class="elementor-cta__button elementor-button elementor-size-sm">
  ```

##### **راهکار:**
1. **بررسی لینک‌ها و افزودن مقدار معتبر برای `href`:**
   اطمینان حاصل کنید که تمام لینک‌ها دارای مقادیر صحیح برای ویژگی `href` هستند. به‌عنوان مثال:
   ```html
   <a class="elementor-cta__button elementor-button elementor-size-sm" href="https://example.com/product-page">
       مشاهدة المنتجات
   </a>
   ```

2. **استفاده از لینک‌های مطمئن:**
   اگر لینک‌ها به دلایلی خالی باقی مانده‌اند، از افزودن یک لینک پیش‌فرض یا هش (`#`) برای جلوگیری از ارور استفاده کنید:
   ```html
   <a class="elementor-cta__button elementor-button elementor-size-sm" href="#">
       قراردادن محصولات
   </a>
   ```

---

#### **2. فایل robots.txt نامعتبر یا موجود نیست**

##### **مشکل:**
- Lighthouse نتوانسته فایل `robots.txt` را دانلود کند. ممکن است فایل در مسیر درست موجود نباشد یا به درستی پیکربندی نشده باشد. این مشکل مانع از تنظیمات صحیح کراولینگ توسط موتورهای جستجو می‌شود.

##### **راهکار:**
1. **ایجاد یا بررسی فایل robots.txt:**
   فایل `robots.txt` را در مسیر ریشه وب‌سایت (مانند `https://alsooqiran.com/robots.txt`) قرار دهید. محتوای پیشنهادی اولیه:
   ```txt
   User-agent: *
   Allow: /
   Sitemap: https://alsooqiran.com/sitemap.xml
   ```

2. **تست فایل robots.txt:**
   - فایل را با ابزارهای تست آنلاین مانند [Robots.txt Tester](https://www.google.com/webmasters/tools/robots-testing-tool) بررسی کنید تا از درستی آن مطمئن شوید.

3. **اطمینان از دسترسی:**
   اطمینان حاصل کنید که فایل از طریق مرورگر یا ابزارهای کراولینگ به درستی قابل دسترسی است.

---

### **مزایای حل این مشکلات:**
1. **بهبود کراولینگ:** موتورهای جستجو می‌توانند صفحات بیشتری از وب‌سایت شما را شناسایی و کراول کنند.
2. **افزایش ایندکس شدن صفحات:** صفحات بیشتری از سایت شما در نتایج جستجو نمایش داده می‌شوند.
3. **تجربه بهتر کاربران:** لینک‌های خراب یا غیرعملیاتی رفع خواهند شد.

### **توصیه کلی:**
- فایل `robots.txt` را با دقت پیکربندی کنید.
- لینک‌ها را به‌طور دوره‌ای بررسی کرده و از وجود ویژگی `href` برای همه لینک‌ها اطمینان حاصل کنید.
